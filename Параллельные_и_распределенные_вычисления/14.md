

Типы параметров для вызовов удаленных методов не ограничены только базовыми типами данных, но могут быть также классами, которые определяет программист, для удаленных методов различают три типа классов: 

1. Классы маршаллизуемые по значению, обычно сериализуются через канал, классы, которые должны быть маршаллизованы либо реализуют интерфейс ISerializable, либо помечаются с помощью атрибута \[Serializable\]. Объекты этих классов не имеют удаленной идентичности т.к. весь объект маршаллизуется через канал, а объект, который сериализуется клиентом является независимым от серверного объекта. Классы маршаллизуемые по значению называются также несвязанными классами т.к. они не имеют данных, которые зависят от домена приложения. 
    
2. Классы маршаллизуемые по ссылке имеют удаленную идентичность объекты не передаются по линии связи, а вместо этого возвращается прокси объект. Класс должен выводиться из MarshalByRefObject, объекты MarshalByRefObject называют объектами, связанными с доменом приложения. Специализированной версией MarshalByRefObject является класс ContextBoundObject. Если класс выводится из ContextBoundObject, требуется прокси даже в том же самом домене приложения, когда пересекаются границы контекстов. 
    
3. Классы, которые не являются сериализуемыми. Не могут использоваться в параметрах открытых методов удаленных объектов. Эти классы связаны с доменом приложения, где они созданы, такие классы должны использоваться, если класс имеет члены данных, допустимые только в домене приложения (например дескриптор файла Win32). 
    

	Создадим классы **MySerialized** и **MyRemote**:

```
using System; 

namespace MyProgram { 

    [Serializable] 

    public class MySerialized() { 

        public MySerialized(int val) { 

            a = val; 

        } 

        public void Foo() { 

            Console.WriteLine(“foo выполняется”); 

        } 

        public int A { 

            get { 

                 Console.WriteLine(“сериализация”); 

                 return a; 

            } 

            set { 

                a = value; 

            } 

        } 

        protected int a; 

    } 

    public class MyRemote : System.MarshalByRefObject { 

        public MyRemote(int val) { 

                a = val; 

        } 

        public void Foo() { 

            Console.Writeline(“foo по ссылке”); 

        } 

        public int A { 

            get { 

                 Console.WriteLine(“объект по ссылке”); 

                 return a; 

            } 

            set { 

                a = value; 

            } 

        } 

        protected int a; 

    } 

} 

Пример использования: 

public class Hello : System.MarshalByRefObject { 

    public Hello() { 

        Console.WriteLine(“Объект создан”); 

    } 

    ~Hello() { 

        Console.WriteLine(“Объект уничтожен”); 

    } 

    public string Greeting(string name) { 

        return “Привет, “ + name; 

    } 

    public MySerialized GetMySerialized() { 

        return new MySerialized(4711); 

    } 

    Public MyRemote GetMyRemote() { 

        return new MyRemote(4712); 

    } 

}

  
```
[< Previous](13.md) | [Next >](15.md)